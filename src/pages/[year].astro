---
import Document from '../Document.astro';
import { EventLayout } from '../components/layouts/EventLayout';
import { getEvent, getAllEvents } from '../services/contentful';

export async function getStaticPaths() {
  const events = await getAllEvents();
  return events.map((event) => ({ params: { year: event.fields.year } }));
}

const { year } = Astro.params;
const [event, pastEvents] = await getEvent({
  isPreview: false,
  year: year as string,
});
---

<Document>
  <EventLayout
    client:load
    event={event}
    pastEvents={pastEvents}
    isPastEvent
    year={year}
  />
</Document>
